# node-note
node学习笔记

## 2018-10-10 笔记

## 一、 node 基础知识学习

### 1. node 创建第一个应用

Node.js 应用是由以下3部分组成：

1. **引入 required 模块：** 使用 required 指令载入 node 模块
2. **创建服务器：** 服务器可以监听客户端请求
3. **接收请求与相应请求：** 服务器很容易创建，客户端可以使用浏览器或终端发送 HTTP 请求，服务器接收请求后返回响应数据

### 2. node 回调函数

node 异步编程的直接体现就是回调

node 所有 API 都支持回调函数

阻塞模式是按顺序执行，而非阻塞是不按循序执行

### 3. node 事件循环

node 基本上所有机制都是用设计模式中的**观察者模式**实现

node 单线程类似进入一个 **while(true)** 的事件循环，直到没有事件观察者退出，每个异步事件都生成一个事件观察者，如果有事件发生就调用该回调函数

### 4. node EventEmitter

node 所有的异步 I/O 操作在完成时都会发送一个事件到事件队列

events 模块只提供了一个对象： events.EventEmitter

EventEmitter 的核心就是 **事件触发** 与 **事件监听器** 功能的封装

EventEmitter 的每个事件由 **一个事件名** 和 **若干个参数** 组成，事件名是一个字符串

常用 API 说明

| API    | 描述          |            
| :----: | ------------- |
|once(event, listener)|为指定事件注册一个单次监听器，即 监听器最多只会触发一次，触发后立刻解除该监听器|
|removeListener(event, listener)|移除指定事件的某个监听器，监听器必须是该事件已经注册过的监听器<br>它接受两个参数，第一个是事件名称，第二个是回调函数名称|
|removeAllListeners([event])|移除所有事件的所有监听器， 如果指定事件，则移除指定事件的所有监听器|
|setMaxListeners(n)|默认情况下， EventEmitters 如果你添加的监听器超过 10 个就会输出警告信息 setMaxListeners 函数用于提高监听器的默认限制的数量|
|listeners(event)|返回指定事件的监听器数组|

类方法

| API    | 描述          |            
| :----: | ------------- |
|listenerCount(emitter, event)|返回指定事件的监听器数量|

大多数时候我们不会直接使用 EventEmitter，而是在对象中继承它。包括 fs、net、 http 在内的，只要是支持事件响应的核心模块都是 EventEmitter 的子类

原因有两点：
>1. 具有某个实体功能的对象实现事件符合语义， 事件的监听和发生应该是一个对象的方法。
>2. JavaScript 的对象机制是基于原型的，支持部分多重继承，继承 EventEmitter 不会打乱对象原有的继承关系。

### 5. node Buffer

### 6. node Stream

Node Stream 有四种流类型：
>1. Readable - 可读操作。
>2. Writable - 可写操作。
>3. Duplex - 可读可写操作.
>4. Transform - 操作被写入数据，然后读出结果。

所有的 Stream 对象都是 EventEmitter 的实例。常用的事件有：
>1. data - 当有数据可读时触发。
>2. end - 没有更多的数据可读时触发。
>3. error - 在接收和写入过程中发生错误时触发。
>4. finish - 所有数据已被写入到底层系统时触发。

- **管道流：** 管道提供了一个输出流到输入流的机制。通常我们用于从一个流中获取数据并将数据传递到另外一个流中。

- **链式流：** 链式是通过连接输出流到另外一个流并创建多个流操作链的机制。链式流一般用于管道操作。
